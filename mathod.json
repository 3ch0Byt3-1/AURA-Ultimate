if (Process.GetProcessesByName("HD-Player").Length == 0)
{
    Sta.Text = "❌ Open Your Emulator First!";
    Console.Beep(240, 300);
    return;
}

Sta.Text = "🚀 Injecting Sniper Scope Without FPS Drop...";

await Task.Run(async () =>
{
    string search = "60 40 cd cc 8c 3f 8f c2 f5 3c cd cc cc 3d 06 00 00 00 00 00 00 00 00 00 00 00 00 00 f0 41 00 00 48 42 00 00 00 3f 33 33 13 40 00 00 b0 3f 00 00 80 3f 01";
    string replace = "60 40 cd cc 8c 3f 8f c2 f5 3c cd cc cc 3d 06 00 00 00 00 00 ff ff 00 00 00 00 00 00 f0 41 00 00 48 42 00 00 00 3f 33 33 13 40 00 00 b0 3f 00 00 00 3f 01";

    memory.OpenProcess("HD-Player");

    var results = await memory.AoBScan(search, writable: true);
    if (!results.Any())
    {
        Sta.Text = "❌ Sniper Scope Injection Failed!";
        Console.Beep(240, 300);
        return;
    }

    // **Optimized Multi-Threaded Patch**
    Parallel.ForEach(results, address =>
    {
        memory.WriteMemory(address.ToString("X"), "bytes", replace);
    });

    Sta.Text = "✅ Sniper Scope Injected with 0% FPS Drop!";
    Console.Beep(400, 300);
});
